"use strict";(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[436],{5077:function(t,e,s){var i;s.d(e,{a:function(){return i}}),function(t){t["AWAITING_WRITER"]="Edited, awaiting writer approval",t["AWAITING_EDITOR"]="Submitted, awaiting editor's approval/ edits",t["POSTED"]="Posted",t["POSTED_AWAITING_WRITER"]="Posted, awaiting writer's approval/ edits",t["POSTED_AWAITING_EDITOR"]="Posted, awaiting editor's approval/ edits"}(i||(i={}))},5171:function(t,e,s){s.d(e,{Z:function(){return I}});var i=s(3396),o=s(7139);const r={class:"card"},n={class:"card-header banner"},a={class:"card-header-title title is-1"},d={class:"card-header-title subtitle is-3"},u={class:"card-header-title subtitle is-6"},l=["innerHTML"];function c(t,e,s,c,p,h){return(0,i.wg)(),(0,i.iD)("div",r,[(0,i._)("header",n,[(0,i._)("h1",a,(0,o.zw)(t.post.title),1),(0,i._)("h2",d,(0,o.zw)(t.post.subtitle),1),(0,i._)("h3",u,(0,o.zw)(t.getPostInfo()),1)]),(0,i._)("div",{class:"card-content content",innerHTML:t.post.content},null,8,l),(0,i._)("p",null,"Post ID: "+(0,o.zw)(t.post._id),1)])}var p=s(5077);const h=s(6797);var m=(0,i.aZ)({name:"Article",props:{post:{type:Object,required:!0}},methods:{getPostInfo(){return this.post.status===p.a.POSTED?"Posted by: "+this.post.writer+" on "+this.getFormattedDateTime(this.post.postedDate):"Submitted by: "+this.post.writer+" on "+this.getFormattedDateTime(this.post.submittedDate)},getFormattedDateTime(t){return h(t).format("DD MMM YYYY")}}}),g=s(89);const E=(0,g.Z)(m,[["render",c],["__scopeId","data-v-0b7c327c"]]);var I=E},6843:function(t,e,s){s.r(e),s.d(e,{default:function(){return k}});var i=s(3396);const o={class:"container"},r={key:1};function n(t,e,s,n,a,d){const u=(0,i.up)("Submission");return(0,i.wg)(),(0,i.iD)("div",o,[null!=d.user?((0,i.wg)(),(0,i.j4)(u,{key:0,id:t.$route.params.id,onTitle:d.onTitleSet},null,8,["id","onTitle"])):((0,i.wg)(),(0,i.iD)("p",r,"Please Login to view the submission"))])}var a=s(7139);const d={key:0,class:"error"},u={key:1,class:"Post box"},l={class:"title"},c={key:1},p={key:2};function h(t,e,s,o,r,n){const h=(0,i.up)("Article"),m=(0,i.up)("Editor");return t.isError||!t.post?((0,i.wg)(),(0,i.iD)("div",d,"No post found")):((0,i.wg)(),(0,i.iD)("div",u,[(0,i._)("div",l,(0,a.zw)(t.post.status),1),(0,i._)("button",{class:"button {toggled: isEditor}",onClick:e[0]||(e[0]=e=>t.toggleIsEditor())}," Edit post "),(0,i._)("button",{class:"button is-danger",onClick:e[1]||(e[1]=e=>t.deletePost())},"Delete Post"),t.showApproveAndPostButton()?((0,i.wg)(),(0,i.iD)("button",{key:0,class:"button is-primary",onClick:e[2]||(e[2]=e=>t.approve())}," Approve and Post ")):(0,i.kq)("",!0),!t.isEditor&&t.post?((0,i.wg)(),(0,i.iD)("div",c,[(0,i.Wm)(h,{post:t.post},null,8,["post"])])):((0,i.wg)(),(0,i.iD)("div",p,[(0,i.Wm)(m,{user:t.user,content:t.post.content,displayTitle:t.post.title,displaySubtitle:t.post.subtitle,onPost:t.onPost},null,8,["user","content","displayTitle","displaySubtitle","onPost"])]))]))}var m=s(6265),g=s.n(m),E=s(5077),I=s(3830),T=s(5171),v=s(7822);const b="https://api.nuscas.com/submissions/";var w=(0,i.aZ)({name:"Submission",components:{Editor:I.Z,Article:T.Z},props:{id:String},data(){return{post:null,isEditor:!1,isError:!1}},methods:{toggleIsEditor(){this.isEditor=!this.isEditor},get(){g().get(b+this.id,{params:this.token}).then((t=>{this.post=t.data,this.$emit("title",t.data.title)})).catch((()=>{this.isError=!0}))},deletePost(){g()["delete"](b,{data:{id:this.id,token:this.token}}).then((()=>v.Z.go(-1)))},onPost(t){g().patch(b+this.id,{token:this.token,title:t.title,subtitle:t.subtitle,content:t.content,user:this.user}).catch((t=>{alert("Edit failed("+t.code+")")})).then((t=>{t&&"OK"==t.data?(alert("Edit success"),this.$emit("posted"),this.get(),this.toggleIsEditor()):alert("Edit failed")}))},approve(){g().post(b+this.id+"/approve",{token:this.token}).catch((t=>{alert("Post failed("+t.code+")")})).then((t=>{t&&"OK"==t.data?(alert("Post success"),this.$emit("posted"),this.get()):alert("Edit failed")}))},showApproveAndPostButton(){if(this.post&&this.user&&!this.isEditor){if("admin"==this.user.role&&(this.post.status==E.a.AWAITING_EDITOR||this.post.status==E.a.POSTED_AWAITING_EDITOR)&&this.user.username!=this.post.writer)return!0;if(this.user.username==this.post.writer&&(this.post.status==E.a.AWAITING_WRITER||this.post.status==E.a.POSTED_AWAITING_WRITER))return!0}return!1}},mounted(){this.get()},computed:{user(){return this.$store.getters.user},token(){return this.$store.getters.token}}}),P=s(89);const _=(0,P.Z)(w,[["render",h],["__scopeId","data-v-767c9f29"]]);var D=_,f={name:"SubmissionPage",data(){return{title:""}},components:{Submission:D},metaInfo(){return{title:"Admin",titleTemplate:"%s | "+this.title}},methods:{onTitleSet(t){this.title=t,document.title="NUSCAS | "+t}},computed:{user(){return this.$store.getters.user}}};const A=(0,P.Z)(f,[["render",n],["__scopeId","data-v-9d5b4a9a"]]);var k=A}}]);
//# sourceMappingURL=436.6e5e32ae.js.map