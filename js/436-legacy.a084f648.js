"use strict";(self["webpackChunkclient"]=self["webpackChunkclient"]||[]).push([[436],{5077:function(t,e,s){var i;s.d(e,{a:function(){return i}}),function(t){t["AWAITING_WRITER"]="Edited, awaiting writer approval",t["AWAITING_EDITOR"]="Submitted, awaiting editor's approval/ edits",t["POSTED"]="Posted",t["POSTED_AWAITING_WRITER"]="Posted, awaiting writer's approval/ edits",t["POSTED_AWAITING_EDITOR"]="Posted, awaiting editor's approval/ edits"}(i||(i={}))},5171:function(t,e,s){s.d(e,{Z:function(){return v}});var i=s(6252),o=s(3577),n={class:"card"},r={class:"card-header banner"},a={class:"card-header-title title is-1"},u={class:"card-header-title subtitle is-3"},d={class:"card-header-title subtitle is-6"},c=["innerHTML"];function l(t,e,s,l,p,h){return(0,i.wg)(),(0,i.iD)("div",n,[(0,i._)("header",r,[(0,i._)("h1",a,(0,o.zw)(t.post.title),1),(0,i._)("h2",u,(0,o.zw)(t.post.subtitle),1),(0,i._)("h3",d,(0,o.zw)(t.getPostInfo()),1)]),(0,i._)("div",{class:"card-content content",innerHTML:t.post.content},null,8,c),(0,i._)("p",null,"Post ID: "+(0,o.zw)(t.post._id),1)])}var p=s(5077),h=s(381),f=(0,i.aZ)({name:"Article",props:{post:{type:Object,required:!0}},methods:{getPostInfo:function(){return this.post.status===p.a.POSTED?"Posted by: "+this.post.writer+" on "+this.getFormattedDateTime(this.post.postedDate):"Submitted by: "+this.post.writer+" on "+this.getFormattedDateTime(this.post.submittedDate)},getFormattedDateTime:function(t){return h(t).format("DD MMM YYYY")}}}),m=s(3744);const g=(0,m.Z)(f,[["render",l],["__scopeId","data-v-0b7c327c"]]);var v=g},6843:function(t,e,s){s.r(e),s.d(e,{default:function(){return k}});var i=s(6252),o={class:"container"},n={key:1};function r(t,e,s,r,a,u){var d=(0,i.up)("Submission");return(0,i.wg)(),(0,i.iD)("div",o,[null!=u.user?((0,i.wg)(),(0,i.j4)(d,{key:0,id:t.$route.params.id,onTitle:u.onTitleSet},null,8,["id","onTitle"])):((0,i.wg)(),(0,i.iD)("p",n,"Please Login to view the submission"))])}var a=s(3577),u={key:0,class:"error"},d={key:1,class:"Post box"},c={class:"title"},l={key:1},p={key:2};function h(t,e,s,o,n,r){var h=(0,i.up)("Article"),f=(0,i.up)("Editor");return t.isError||!t.post?((0,i.wg)(),(0,i.iD)("div",u,"No post found")):((0,i.wg)(),(0,i.iD)("div",d,[(0,i._)("div",c,(0,a.zw)(t.post.status),1),(0,i._)("button",{class:"button {toggled: isEditor}",onClick:e[0]||(e[0]=function(e){return t.toggleIsEditor()})}," Edit post "),(0,i._)("button",{class:"button is-danger",onClick:e[1]||(e[1]=function(e){return t.deletePost()})},"Delete Post"),t.showApproveAndPostButton()?((0,i.wg)(),(0,i.iD)("button",{key:0,class:"button is-primary",onClick:e[2]||(e[2]=function(e){return t.approve()})}," Approve and Post ")):(0,i.kq)("",!0),!t.isEditor&&t.post?((0,i.wg)(),(0,i.iD)("div",l,[(0,i.Wm)(h,{post:t.post},null,8,["post"])])):((0,i.wg)(),(0,i.iD)("div",p,[(0,i.Wm)(f,{user:t.user,content:t.post.content,displayTitle:t.post.title,displaySubtitle:t.post.subtitle,onPost:t.onPost},null,8,["user","content","displayTitle","displaySubtitle","onPost"])]))]))}var f=s(9669),m=s.n(f),g=s(5077),v=s(937),E=s(5171),I=s(7822),T="https://api.nuscas.com/submissions/",b=(0,i.aZ)({name:"Submission",components:{Editor:v.Z,Article:E.Z},props:{id:String},data:function(){return{post:null,isEditor:!1,isError:!1}},methods:{toggleIsEditor:function(){this.isEditor=!this.isEditor},get:function(){var t=this;m().get(T+this.id,{params:this.token}).then((function(e){t.post=e.data,t.$emit("title",e.data.title)})).catch((function(){t.isError=!0}))},deletePost:function(){m()["delete"](T,{data:{id:this.id,token:this.token}}).then((function(){return I.Z.go(-1)}))},onPost:function(t){var e=this;m().patch(T+this.id,{token:this.token,title:t.title,subtitle:t.subtitle,content:t.content,user:this.user}).catch((function(t){alert("Edit failed("+t.code+")")})).then((function(t){t&&"OK"==t.data?(alert("Edit success"),e.$emit("posted"),e.get(),e.toggleIsEditor()):alert("Edit failed")}))},approve:function(){var t=this;m().post(T+this.id+"/approve",{token:this.token}).catch((function(t){alert("Post failed("+t.code+")")})).then((function(e){e&&"OK"==e.data?(alert("Post success"),t.$emit("posted"),t.get()):alert("Edit failed")}))},showApproveAndPostButton:function(){if(this.post&&this.user&&!this.isEditor){if("admin"==this.user.role&&(this.post.status==g.a.AWAITING_EDITOR||this.post.status==g.a.POSTED_AWAITING_EDITOR)&&this.user.username!=this.post.writer)return!0;if(this.user.username==this.post.writer&&(this.post.status==g.a.AWAITING_WRITER||this.post.status==g.a.POSTED_AWAITING_WRITER))return!0}return!1}},mounted:function(){this.get()},computed:{user:function(){return this.$store.getters.user},token:function(){return this.$store.getters.token}}}),w=s(3744);const P=(0,w.Z)(b,[["render",h],["__scopeId","data-v-767c9f29"]]);var _=P,D={name:"SubmissionPage",data:function(){return{title:""}},components:{Submission:_},metaInfo:function(){return{title:"Admin",titleTemplate:"%s | "+this.title}},methods:{onTitleSet:function(t){this.title=t,document.title="NUSCAS | "+t}},computed:{user:function(){return this.$store.getters.user}}};const A=(0,w.Z)(D,[["render",r],["__scopeId","data-v-9d5b4a9a"]]);var k=A}}]);
//# sourceMappingURL=436-legacy.a084f648.js.map